{"version":3,"file":"Popover-n9vclR9E.js","sources":["../design-system/components/Popover/Popover.tsx"],"sourcesContent":["/**\n * Popover Component\n *\n * A floating container component that appears near a trigger element.\n * Typically used for contextual actions, forms, or additional information.\n * Matches Figma Popover design.\n *\n * Figma: https://www.figma.com/design/pFe8ykz2F9QdvabPsTGl1L/Spark-%7C-Components?node-id=1368-6681\n *\n * @example\n * <Popover\n *   visible={isOpen}\n *   onClose={() => setIsOpen(false)}\n *   anchorEl={buttonRef.current}\n * >\n *   <p>Popover content</p>\n * </Popover>\n */\n\nimport React, { useRef, useEffect } from 'react';\nimport clsx from 'clsx';\nimport styles from './Popover.module.css';\n\nexport interface PopoverProps {\n  /** Whether the popover is visible */\n  visible?: boolean;\n\n  /** Callback when popover should close */\n  onClose?: () => void;\n\n  /** Anchor element to position the popover near */\n  anchorEl?: HTMLElement | null;\n\n  /** Popover content */\n  children: React.ReactNode;\n\n  /** Size variant */\n  size?: 'small' | 'medium' | 'large';\n\n  /** Position relative to anchor */\n  placement?: 'top' | 'bottom' | 'left' | 'right' | 'bottom-start' | 'bottom-end';\n\n  /** Additional CSS class */\n  className?: string;\n\n  /** z-index for stacking */\n  zIndex?: number;\n}\n\nexport function Popover({\n  visible = false,\n  onClose,\n  anchorEl,\n  children,\n  size = 'medium',\n  placement = 'bottom',\n  className,\n  zIndex = 1001,\n}: PopoverProps) {\n  const popoverRef = useRef<HTMLDivElement>(null);\n  const [position, setPosition] = React.useState({ top: 0, left: 0 });\n\n  // Calculate position based on anchor element\n  useEffect(() => {\n    if (!visible || !anchorEl || !popoverRef.current) return;\n\n    const updatePosition = () => {\n      const anchorRect = anchorEl.getBoundingClientRect();\n      const popoverRect = popoverRef.current!.getBoundingClientRect();\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n\n      let top = 0;\n      let left = 0;\n\n      switch (placement) {\n        case 'bottom':\n          top = anchorRect.bottom + 8;\n          left = anchorRect.left + anchorRect.width / 2 - popoverRect.width / 2;\n          break;\n        case 'bottom-start':\n          top = anchorRect.bottom + 8;\n          left = anchorRect.left;\n          break;\n        case 'bottom-end':\n          top = anchorRect.bottom + 8;\n          left = anchorRect.right - popoverRect.width;\n          break;\n        case 'top':\n          top = anchorRect.top - popoverRect.height - 8;\n          left = anchorRect.left + anchorRect.width / 2 - popoverRect.width / 2;\n          break;\n        case 'left':\n          top = anchorRect.top + anchorRect.height / 2 - popoverRect.height / 2;\n          left = anchorRect.left - popoverRect.width - 8;\n          break;\n        case 'right':\n          top = anchorRect.top + anchorRect.height / 2 - popoverRect.height / 2;\n          left = anchorRect.right + 8;\n          break;\n      }\n\n      // Viewport boundary detection - keep popover fully visible\n      const margin = 8;\n\n      // Check right edge\n      if (left + popoverRect.width > viewportWidth - margin) {\n        left = viewportWidth - popoverRect.width - margin;\n      }\n\n      // Check left edge\n      if (left < margin) {\n        left = margin;\n      }\n\n      // Check bottom edge\n      if (top + popoverRect.height > viewportHeight - margin) {\n        // If popover goes below viewport, try to position it above anchor\n        const topAlternative = anchorRect.top - popoverRect.height - 8;\n        if (topAlternative >= margin) {\n          top = topAlternative;\n        } else {\n          // If it doesn't fit above either, position at bottom with scroll\n          top = viewportHeight - popoverRect.height - margin;\n        }\n      }\n\n      // Check top edge\n      if (top < margin) {\n        top = margin;\n      }\n\n      setPosition({ top, left });\n    };\n\n    updatePosition();\n    window.addEventListener('resize', updatePosition);\n    window.addEventListener('scroll', updatePosition, true);\n\n    return () => {\n      window.removeEventListener('resize', updatePosition);\n      window.removeEventListener('scroll', updatePosition, true);\n    };\n  }, [visible, anchorEl, placement]);\n\n  useEffect(() => {\n    if (!visible) return;\n\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        popoverRef.current &&\n        !popoverRef.current.contains(event.target as Node) &&\n        anchorEl &&\n        !anchorEl.contains(event.target as Node)\n      ) {\n        onClose?.();\n      }\n    }\n\n    function handleEscape(event: KeyboardEvent) {\n      if (event.key === 'Escape') {\n        onClose?.();\n      }\n    }\n\n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('keydown', handleEscape);\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [visible, onClose, anchorEl]);\n\n  if (!visible) return null;\n\n  return (\n    <div\n      ref={popoverRef}\n      className={clsx(\n        styles.popover,\n        styles[`size-${size}`],\n        styles[`placement-${placement}`],\n        className\n      )}\n      style={{\n        zIndex,\n        top: `${position.top}px`,\n        left: `${position.left}px`,\n      }}\n      role=\"dialog\"\n      aria-modal=\"false\"\n    >\n      <div className={styles.content}>{children}</div>\n      <div className={styles.arrow} />\n    </div>\n  );\n}\n"],"names":["Popover","visible","onClose","anchorEl","children","size","placement","className","zIndex","popoverRef","useRef","position","setPosition","React","useEffect","updatePosition","anchorRect","popoverRect","viewportWidth","viewportHeight","top","left","margin","topAlternative","handleClickOutside","event","handleEscape","jsxs","clsx","styles","jsx"],"mappings":"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"}